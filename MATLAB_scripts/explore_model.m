% Script:  explore_model.m% Author:  Louis Lin% Org:     Auckland Bioengineering Institute% Purpose: Explore the cell model by generating plots of eta and beta%          perturbations%% initclcclearclose alladdpath('../MEA_simulation') % for simplified_cell_model.m% beta and eta both arraysbeta = linspace(0, 0.002, 2); % ms^-1 (default 0.000975)eta = linspace(0, 0.08, 2); % ms^-1 (default 0.0389)G_Na = 8; % mSG_BK = 1.2; % mSG_Ca = 4; % mStspan = [600000, 660000]; % msshow_plot = false; % plot Vm vs. tbeta_plot_ind = 1; % index of beta to hold constant in ploteta_plot_ind = 1; % index of beta to hold constant in plot% store freqfreq_all = zeros(length(beta), length(eta));% start timertic%% main% explore slow wave frequency with various parameterscounter = 1;for eta_i = 1:length(eta)    for beta_i = 1:length(beta)        [~,~,~,~,freq] = simplified_cell_model(beta(beta_i), eta(eta_i), 8, 1.2, 4, tspan, show_plot);        freq_all(beta_i, eta_i) = freq;        counter = counter + 1;    endend% print iteration timefprintf('Average time per iteration: %f s', toc/(length(eta) * length(beta)));%% plotfiguret = tiledlayout(2,1,'Padding','none'); % 2 by 1 plot% plot one eta vs range of betanexttile;plot(beta, freq_all(:,eta_plot_ind))title(['$\beta$ vs. Freq ($\eta$ = ', num2str(eta(eta_plot_ind)), ' ms$^{-1}$)'], 'Interpreter', 'Latex')xlabel('$\beta$ ($ms^{-1}$)', 'Interpreter', 'Latex')ylabel('Frequency (cpm)')% plot range of eta vs one betanexttile;plot(eta, freq_all(beta_plot_ind,:))title(['$\eta$ vs. Freq ($\beta$ = ', num2str(beta(beta_plot_ind)), ' ms$^{-1}$)'], 'Interpreter', 'Latex')xlabel('$\eta$ ($ms^{-1}$)', 'Interpreter', 'Latex')ylabel('Frequency (cpm)')% plot range of eta vs range of betafiguremesh(beta, eta, freq_all);title('$\eta$ and $\beta$ vs. Frequency', 'Interpreter', 'Latex')xlabel('$\beta$ ($ms^{-1}$)', 'Interpreter', 'Latex')ylabel('$\eta$ ($ms^{-1}$)', 'Interpreter', 'Latex')zlabel('Frequency (cpm)')